if (typeof MAQ === "undefined") { MAQ = {} } MAQ.Utils = function () { var e = {}; var t = function (e) { if (typeof e === "undefined" || !e) { return false } return true }; e.IsSafe = t; var n = function (e) { if (t(e) && typeof e === "object") { var n = 0, r; for (r in e) { e.hasOwnProperty(r) && n++ } return n === 0 } return true }; e.IsEmptyObject = n; var r = function (e, n) { var i = [], u = "{...}", f = ",", l = ":", c = "=>", h; n = v(n) ? n : 4; if (t(e) && (s(e) || a(e) || o(e))) { if (s(e)) { i.push("["); for (h = 0; h < e.length; h++) { i.push(h); i.push(c); if (a(e[h]) || s(e[h])) { i.push(n > 0 ? r(e[h], n - 1) : u) } else { i.push(e[h]) } i.push(f) } if (i.length > 1) { i.pop() } i.push("]") } else if (a(e)) { i.push("{"); for (h in e) { if (e.hasOwnProperty(h)) { i.push(h); i.push(l); if (a(e[h]) || s(e[h])) { i.push(n > 0 ? r(e[h], n - 1) : u) } else { i.push(e[h]) } } i.push(f) } if (i.length > 1) { i.pop() } i.push("}") } else { i.push(e) } } return i.join(" ") }; e.Dump = r; var i = function (e, n) { if (t(e)) { if (s(e)) { return e.length } if (o(e)) { return t(n) && n === true ? P(e).length : e.length } if (a(e)) { var r = 0, i; for (i in e) { if (e.hasOwnProperty(i)) { r++ } } return r } } return 0 }; e.Length = i; var s = function (e) { return d(e) === "array" }; e.IsArray = s; var o = function (e) { return d(e) === "string" }; e.IsString = o; var u = function (e) { return d(e) === "boolean" }; e.IsBoolean = u; var a = function (e) { return d(e) === "object" }; e.IsObject = a; var f = function (e) { return d(e) === "function" }; e.IsFunction = f; var l = function (e) { return d(e) === "number" }; e.IsInteger = l; var c = function (e) { return d(e) === "date" }; e.IsDate = c; var h = function (e) { return d(e) === "nodelist" }; e.IsNodeList = h; var p = {}; (function () { var e = "Boolean Number String Function Array Date RegExp Object NodeList".split(" "), t = 0; for (; t < e.length; t++) { p["[object " + e[t] + "]"] = e[t].toLowerCase() } })(); var d = function (e) { if (e === null) { return "null" } return p[Object.prototype.toString.call(e)] || "object" }; e.GetType = d; var v = function (e) { if (t(e)) { return /^\d+$/.test(e) } return false }; e.IsNumber = v; var m = function (e) { if (t(e)) { return /^[+-]?\d+(\.\d+)?$/.test(e) } }; e.IsDecimal = m; var g = function (e, t) { return o(e) && o(t) && P(e) === P(t) }; e.oComparisonFn = { oStringComparison: { Trim: g } }; var y = function (e, t) { if (n(t) && !n(e)) { return e } if (!n(t) && !n(e)) { var r = {}; for (var i in t) { if (t.hasOwnProperty(i)) { for (var s in e) { if (e.hasOwnProperty(s)) { if (t.hasOwnProperty(s)) { if (a(e[s]) && a(t[s])) { r[s] = y(e[s], t[s]) } else { r[s] = e[s] } } else { r[s] = e[s] } } } if (!e.hasOwnProperty(i)) { r[i] = t[i] } } } return r } return t }; e.GetUserDefinedWithDefault = y; e.Extend = y; var b = function (e, t, n) { if (a(e)) { var r = "", i; for (i in e) { if (e.hasOwnProperty(i)) { if (r === "") { r = i + t + e[i] } else { r = r + n + i + t + e[i] } } } return r } if (s(e)) { return e.join(t) } if (o(e)) { return e } }; e.JoinKeyValuePairs = b; var w = function (e) { if (null === e || "object" !== typeof e) { return e } if (c(e)) { var t = new Date; t.setTime(e.getTime()); return t } if (s(e)) { var t = []; for (var n = 0, r = e.length; n < r; ++n) { t[n] = w(e[n]) } return t } if (a(e)) { var t = {}; for (var i in e) { if (e.hasOwnProperty(i)) { t[i] = w(e[i]) } } return t } throw new Error("Unable to copy object! Its type isn't supported.") }; e.Clone = w; var E = function (e, n, r, i) { var u = w(e); if (t(i)) { if (s(i)) { for (var a = 0; a < i.length; a++) { if (o(i[a]) && u.hasOwnProperty(i[a])) { delete u[i[a]] } } } else if (o(i) && u.hasOwnProperty(i)) { delete u[i] } } return b(u, n, r) }; e.JoinJSON = E; var S = function (e, n, r) { if (!t(n)) { return -1 } if (s(n)) { var i = 0, u = -1; for (; i < n.length; i++) { var l = false; if (f(r)) { l = r(n[i], e) } else { l = n[i] === e } if (l) { u = i; break } } return u } if (o(n)) { return n.indexOf(e) } if (a(n)) { return n.hasOwnProperty(e) === true ? 0 : -1 } }; e.IndexOf = S; var x = function () { var e = window.location.pathname; return e.substring(e.lastIndexOf("/") + 1) }; e.CurrentPageName = x; var T = {}; var N = function () { return typeof Storage !== "undefined" && typeof sessionStorage !== "undefined" }; var C = function (e) { if (N()) { return sessionStorage[e] } return T.hasOwnProperty(e) ? T[e] : null }; e.GetCacheData = C; var k = function (e, t) { if (o(e)) { if (N()) { sessionStorage[e] = t } else { T[e] = t } } }; e.SetCacheData = k; e.SaveCacheData = k; var L = function (e) { if (o(skey)) { if (N()) { sessionStorage.removeItem(skey) } else { T.hasOwnProperty(skey) && delete T.skey } } }; e.RemoveCache = L; e.DeleteFromCache = L; var A = function () { N() && sessionStorage.clear(); T = {} }; e.FlushCache = A; var O = function (e) { try { e = JSON.parse(e); return { result: a(e), validJSON: e } } catch (t) { return { result: false, Exception: t } } }; e.IsValidJSON = O; var M = function (e) { var t = {}; if (i(e) > 1) { e.replace(/(\w+)=([^&]*)/gi, function (e, n, r) { t[n] = r }) } return t }; e.QueryStringToJSON = M; var _ = function () { var e = x(); if (T.hasOwnProperty(e)) { return T[e] } else { T[e] = M(window.location.search); return T[e] } }; e.GetQueryStringParams = _; var D = function (e) { if (t(e) && o(e)) { var n = _(); for (var r in n) { if (n.hasOwnProperty(r)) { if (r.toLowerCase() === e.toLowerCase()) { return n[r] } } } return null } }; e.GetQueryParam = D; var P = function (e) { if (!o(e)) { return e } if (typeof String.prototype.trim !== "function") { return e.replace(/^\s+|\s+$/g, "") } return e.trim() }; e.Trim = P; e.UseLog = true; e.ShowLogOnPage = false; var H = function (n, i, s) { if (e.UseLog) { var o = "LOG: ", u = r(n, t(s) ? s : 4), a = "MAQ-Utilities-Log-Div", f = null, l = document.getElementsByTagName("BODY"); if (l.length > 0) { l = l[0] } if (typeof console !== "undefined" && t(console) && typeof console.log !== "undefined" && t(console.log)) { console.log(u) } else { u = o + u; if (t(i) && i) { alert(u) } else { f = document.querySelector("#" + a); if (!t(f)) { f = document.createElement("DIV"); f.setAttribute("id", a); if (!e.ShowLogOnPage) { f.setAttribute("style", "display:none;") } if (l.appendChild) { l.appendChild(f) } } f.innerHTML = f.innerHTML + " <br />" + u } } } }; e.Log = H; var B = function (e, n, r) { if (!m(e)) { return "" } e += ""; r = t(r) ? r : ""; n = t(n) && v(n) ? n : 3; var i = e.split("."), s = i[0], o = i.length > 1 ? "." + i[1] : r, u = new RegExp("(\\d+)(\\d{" + n + "})"); while (u.test(s)) { s = s.replace(u, "$1" + "," + "$2") } return s + o }; e.FormatNumeric = B; var j = function (e, n) { return B(e, t(n) ? n : 3) }; e.FormatNumber = j; var F = function (e) { var t = B(e, 3, ".00"), n = S(".", t); return t.substring(0, n + 3) }; e.FormatAmountLC = F; var I = function (e) { var t = F(e); if (i(P(t)) > 0) { if (R(t)) { return t.replace("-", "-$") } else { return "$" + t } } return t }; e.FormatAmountCD = I; var q = function (e) { var n = new Date(e); if (t(n)) { return n.format("MM/dd/yyyy") } return e }; e.FormatDate = q; var R = function (e) { if (e.indexOf("-") === 0) { return true } else { return false } }; e.IsNegative = R; var U = function (e, n) { if (t(e) && s(e)) { for (var r = 0; r < e.length; r++) { if (f(n)) { n(e[r], r, e) } } } return e }; e.Walk = U; var z = function (e, t) { var n = []; U(e, function (e, r, i) { t(e, r, i) && n.push(e) }); return n }; e.Filter = z; var W = function (e, t) { if (f(t)) { U(e, function (e, n, r) { r[n] = t(e, n, r) }) } return e }; e.Modify = W; var X = function (e, t, n) { n[t] = P(e) }; var V = function (e) { U(e, X); return e }; e.TrimValues = V; var $ = function (e, t, n) { return i(P(e)) > 0 }; var J = function (e) { return z(e, $) }; e.RemoveEmptyValues = J; var K = function (e) { if (t(e) && o(e)) { return P(e.replace(/[\n\r\t]/g, "")) } return e }; e.RemoveCRLFTab = K; var Q = function (e) { return W(e, K) }; e.RemoveCRLFAndTrim = Q; e.RemoveCRLFTabAndTrim = Q; e.StringSplitOptions = {}; e.StringSplitOptions.Trim = V; e.StringSplitOptions.RemoveEmpty = J; e.StringSplitOptions.RemoveCRLFAndTrim = Q; var G = function (e, n, r) { if (t(e) && o(e)) { var i = e.split(n); if (f(r)) { i = r(i) } return i } return [] }; e.Split = G; var Y = function (t, n) { if (o(t) && a(n)) { var r = G(t, ".", e.StringSplitOptions.Trim), i, s = null; for (i in r) { var u = r[i]; if (n.hasOwnProperty(u)) { n = n[u] } else { return { result: false, value: null } } } return { result: true, value: n } } return { result: false, value: null } }; e.IsPathExist = Y; var Z = function () { return (new Date).valueOf() }; e.GetUniqueNumber = Z; var et = function (e, n) { if (t(e) && t(e.tagName)) { if (!t(n) || !o(n)) { return e.parentNode } var r = e.parentNode; while (t(r) && r.tagName !== n) { r = r.parentNode } return r } return null }; e.Parent = et; return e }()